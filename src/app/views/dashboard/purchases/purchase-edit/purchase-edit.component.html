@if(loading){
<app-loading></app-loading>
}@else{
<form [formGroup]="form">

    <div class="row mb-3">

        <div class="col-lg-12 col-md-6 col-12">
            <app-input-group text="Producto (*)" [icon]="faEdit">
                <input formControlName="name" type="text" class="form-control" placeholder="Nombre del producto"
                    aria-label="name" aria-describedby="basic-name" />
            </app-input-group>
        </div>

        <div class="col-lg-6 col-6">
            <app-input-group text="Cantidad (*)">
                <input formControlName="quantity" type="number" step="0.01" class="form-control" placeholder="Cantidad"
                    aria-label="quantity" aria-describedby="quantity-price" />
            </app-input-group>
        </div>

        <div class="col-lg-6 col-6">
            <label class="mb-2">Unidades</label>
            <app-unit-selected formControlName="unit_id" [units]="units"></app-unit-selected>
        </div>

        <div class="col-lg-6 col-6">
            <app-input-group text="Precio (*)" icontext="S/.">
                <input formControlName="price" type="number" step="0.01" class="form-control" placeholder="0.00"
                    aria-label="price" aria-describedby="basic-price" />
            </app-input-group>
        </div>

        <div class="col-lg-6 col-6">
            <app-input-group text="Total (*)" icontext="S/.">
                <input formControlName="total" type="number" step="0.01" class="form-control" placeholder="0.00"
                    aria-label="price" aria-describedby="basic-price" />
            </app-input-group>
        </div>

        <input type="text" formControlName="section_id" hidden id="">

        <div class="col-lg-12 col-md-12 col-12">

            <label class="mb-2">Escoger Proveedor</label>

            <div class="proveedor mb-3 d-flex justify-content-between align-items-center">

                <ng-select class="w-100 me-2" formControlName="supplier_id" bindValue="id" [items]="suppliers"
                    [addTag]="false" bindLabel="name" placeholder="Escoja una marca">
                    <ng-template ng-label-tmp let-item="item">
                        <fa-icon [icon]="faUser" class="me-2"></fa-icon>
                        {{ item.name }}
                    </ng-template>
                </ng-select>

                <app-button color="outline-dark" [icon]="faPlus"
                    (click)="openVerticallyCentered(newSupplier)">Crear</app-button>
                <!-- <button class="btn btn-outline-primary ms-2">Crear</button> -->

            </div>

        </div>




        <div class="col-lg-12 col-12">
            <label class="mb-2">Observaciones</label>
            <textarea formControlName="observations" rows="3" class="form-control mb-3"
                placeholder="Observaciones"></textarea>
        </div>


    </div>

    <div class="d-flex justify-content-between">

        <app-button [color]="purchase.images_count > 0 ? 'outline-success' : 'outline-secondary'" [icon]="faImages"
            (click)="openVerticallyCentered(content)">Adjuntos ({{ purchase.images_count }}) </app-button>

        <app-button color="success" colortext="white" [icon]="faPlus" [disabled]="disabledButton"
            [loadingIcon]="loadingIcon" (action)="update()">Actualizar Compra</app-button>

    </div>

    <!-- {{ form.value | json }} -->

</form>



<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title fs-5 fw-500">Adjuntar Boletas y Facturas</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <div class="vouchers my-4">
            <app-gallery [path]="`purchases/${purchase.id}/images`"></app-gallery>
        </div>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modal.close('Close click')">Close</button>
    </div>
</ng-template>

<ng-template #newSupplier let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Crear proveedor</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body pb-4">
        <app-supplier-create (emitSupplierCreate)="supplierReceiveCreate($event)"></app-supplier-create>
    </div>

</ng-template>

}

